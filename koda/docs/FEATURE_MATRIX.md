# Koda V2 vs Pi Coding Agent - åŠŸèƒ½çŸ©é˜µ

## Pi Coding Agent åŠŸèƒ½æ¸…å•

åŸºäº [OpenClaw/pi-mono](https://github.com/OpenClaw/pi-mono) æºç åˆ†æ

### æ ¸å¿ƒåŠŸèƒ½

| åŠŸèƒ½ | Pi å®ç° | Koda V2 | çŠ¶æ€ |
|------|---------|---------|------|
| **JSONL ä¼šè¯æ ¼å¼** | âœ… `id/parentId` | âœ… `id/parent_id` | âœ… å®Œå…¨å…¼å®¹ |
| **æ ‘çŠ¶å¯¼èˆª** | âœ… checkout/entries | âœ… checkout/entries | âœ… å®Œå…¨å…¼å®¹ |
| **åˆ†æ”¯æ“ä½œ** | âœ… create/merge/abandon | âœ… create/merge/abandon | âœ… å®Œå…¨å…¼å®¹ |
| **ä¼šè¯æŒä¹…åŒ–** | âœ… ä¿å­˜åˆ°æ–‡ä»¶ | âœ… ä¿å­˜åˆ° `.koda/sessions/` | âœ… å®Œå…¨å…¼å®¹ |

### 4 ä¸ªæ ¸å¿ƒå·¥å…·

| å·¥å…· | Pi å®ç° | Koda V2 | çŠ¶æ€ |
|------|---------|---------|------|
| **read** | âœ… path/offset/limit | âœ… path/offset/limit | âœ… å®Œå…¨å…¼å®¹ |
| **write** | âœ… path/content | âœ… path/content | âœ… å®Œå…¨å…¼å®¹ |
| **edit** | âœ… path/oldText/newText | âœ… path/old_text/new_text | âœ… å®Œå…¨å…¼å®¹ |
| **bash** | âœ… command/timeout/signal | âœ… command/timeout/signal | âœ… å®Œå…¨å…¼å®¹ |

### å·¥å…·ç‰¹æ€§

| ç‰¹æ€§ | Pi å®ç° | Koda V2 | çŠ¶æ€ |
|------|---------|---------|------|
| **å†…å®¹æˆªæ–­** | âœ… 50KB/2000è¡Œ | âœ… 50KB/2000è¡Œ | âœ… å®Œå…¨å…¼å®¹ |
| **å¤´éƒ¨æˆªæ–­** | âœ… æ–‡ä»¶è¯»å–ç”¨ | âœ… `truncate_head()` | âœ… å®Œå…¨å…¼å®¹ |
| **å°¾éƒ¨æˆªæ–­** | âœ… å‘½ä»¤è¾“å‡ºç”¨ | âœ… `truncate_tail()` | âœ… å®Œå…¨å…¼å®¹ |
| **AbortSignal** | âœ… å–æ¶ˆæ“ä½œ | âœ… `AbortSignal` class | âœ… å®Œå…¨å…¼å®¹ |
| **æµå¼è¾“å‡º** | âœ… bash streaming | âœ… bash streaming | âœ… å®Œå…¨å…¼å®¹ |
| **å·¥ä½œç›®å½•** | âœ… cwd å‚æ•° | âœ… base_path | âœ… å®Œå…¨å…¼å®¹ |

### è‡ªæ‰©å±•åŠŸèƒ½

| åŠŸèƒ½ | Pi å®ç° | Koda V2 | çŠ¶æ€ |
|------|---------|---------|------|
| **Agent å†™æ‰©å±•** | âœ… TS ä»£ç ç”Ÿæˆ | âœ… Python ä»£ç ç”Ÿæˆ | âœ… åŠŸèƒ½ç›¸åŒ |
| **çƒ­é‡è½½** | âœ… `import()` | âœ… `importlib` | âœ… åŠŸèƒ½ç›¸åŒ |
| **æ‰©å±•æŒä¹…åŒ–** | âœ… ä¿å­˜åˆ°æ–‡ä»¶ | âœ… ä¿å­˜åˆ° `.koda/extensions/` | âœ… å®Œå…¨å…¼å®¹ |
| **æ‰©å±•éªŒè¯** | âŒ æ—  | âœ… `ExtensionValidator` | ğŸš€ Koda å¢å¼º |

### ä¼šè¯ç®¡ç†ç‰¹æ€§

| ç‰¹æ€§ | Pi å®ç° | Koda V2 | çŠ¶æ€ |
|------|---------|---------|------|
| **ä¼šè¯æ ‘å¯è§†åŒ–** | âœ… text tree | âœ… `get_tree_visualization()` | âœ… å®Œå…¨å…¼å®¹ |
| **èŠ‚ç‚¹çŠ¶æ€** | âœ… implicit | âœ… `NodeStatus` enum | ğŸš€ Koda å¢å¼º |
| **Artifacts** | âœ… implicit | âœ… `node.artifacts` dict | âœ… å®Œå…¨å…¼å®¹ |
| **Session Manager** | âœ… singleton | âœ… `TreeSessionManager` | âœ… å®Œå…¨å…¼å®¹ |

### ç³»ç»Ÿæç¤ºè¯

| ç‰¹æ€§ | Pi å®ç° | Koda V2 | çŠ¶æ€ |
|------|---------|---------|------|
| **åŠ¨æ€æ„å»º** | âœ… æ ¹æ®å·¥å…· | âœ… `SystemPromptBuilder` | âœ… å®Œå…¨å…¼å®¹ |
| **å·¥å…·æè¿°** | âœ… hardcoded | âœ… `TOOL_DESCRIPTIONS` | âœ… å®Œå…¨å…¼å®¹ |
| **ä¸Šä¸‹æ–‡æ³¨å…¥** | âœ… AGENTS.md | âœ… `ContextFile` | âœ… å®Œå…¨å…¼å®¹ |
| **Skills æ”¯æŒ** | âœ… implicit | âœ… `Skill` dataclass | âœ… å®Œå…¨å…¼å®¹ |

## Koda V2 å¢å¼ºåŠŸèƒ½

### è‡ªéªŒè¯å¾ªç¯ (Koda ç‹¬æœ‰)

| åŠŸèƒ½ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| **Validator** | âœ… | ä»£ç è¯­æ³•/ç»“æ„éªŒè¯ |
| **Reflector** | âœ… | å¤±è´¥åˆ†æå’Œä¿®å¤å»ºè®® |
| **è¿­ä»£ä¿®å¤** | âœ… | å¤šæ¬¡å°è¯•ç›´åˆ°æˆåŠŸ |
| **åˆ†æ”¯ä¿®å¤** | âœ… | å¤±è´¥æ—¶åˆ›å»ºä¿®å¤åˆ†æ”¯ |

### æ™ºèƒ½åˆ†æ”¯ç­–ç•¥ (Koda ç‹¬æœ‰)

| åŠŸèƒ½ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| **ç­–ç•¥é€‰æ‹©** | âœ… | è‡ªåŠ¨é€‰æ‹©ä¿®å¤ç­–ç•¥ |
| **åŸåœ°ä¿®å¤** | âœ… | ç®€å•é”™è¯¯ç›´æ¥ä¿®å¤ |
| **åˆ†æ”¯ä¿®å¤** | âœ… | å¤æ‚é”™è¯¯åˆ›å»ºåˆ†æ”¯ |
| **æ‰©å±•ä¿®å¤** | âœ… | ç¼ºå°‘å·¥å…·æ—¶åˆ›å»ºæ‰©å±• |
| **è‡ªåŠ¨åˆå¹¶** | âœ… | ä¿®å¤æˆåŠŸåè‡ªåŠ¨åˆå¹¶ |

### Python åŸç”Ÿä¼˜åŠ¿

| åŠŸèƒ½ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| **ç±»å‹æç¤º** | âœ… | dataclass + type hints |
| **async/await** | âœ… | åŸç”Ÿå¼‚æ­¥æ”¯æŒ |
| **Path å¯¹è±¡** | âœ… | `pathlib.Path` |
| **importlib** | âœ… | Python çƒ­é‡è½½ |

## æµ‹è¯•è¦†ç›–

| æ¨¡å— | æµ‹è¯•çŠ¶æ€ | è¦†ç›–ç‡ |
|------|----------|--------|
| `truncation.py` | âœ… | åŸºç¡€æµ‹è¯•é€šè¿‡ |
| `file_tool.py` | âœ… | æ‰‹åŠ¨æµ‹è¯•é€šè¿‡ |
| `shell_tool.py` | âœ… | æ‰‹åŠ¨æµ‹è¯•é€šè¿‡ |
| `system_prompt.py` | âœ… | æ‰‹åŠ¨æµ‹è¯•é€šè¿‡ |
| `agent_v2.py` | âš ï¸ | éœ€æ›´å¤šæµ‹è¯• |
| `tree_session.py` | âš ï¸ | éœ€æ›´å¤šæµ‹è¯• |
| `extension_engine.py` | âš ï¸ | éœ€æ›´å¤šæµ‹è¯• |

## è¿ç§»æ£€æŸ¥æ¸…å•

ä» Pi Coding Agent è¿ç§»åˆ° Koda V2ï¼š

### å¿…é¡»ä¿®æ”¹
- [x] è¯­è¨€: TypeScript â†’ Python
- [x] å¯¼å…¥: `import { Agent }` â†’ `from koda.core import KodaAgentV2`
- [x] å·¥å…·è°ƒç”¨: `tools.read.execute()` â†’ `await agent.read()`
- [x] å±æ€§å‘½å: `parentId` â†’ `parent_id`, `oldText` â†’ `old_text`

### å¯é€‰å¢å¼º
- [x] å¯ç”¨è‡ªéªŒè¯: `enable_validation=True`
- [x] å¯ç”¨åˆ†æ”¯: `enable_branches=True`
- [x] å¯ç”¨è‡ªæ‰©å±•: `enable_self_extension=True`
- [x] ä½¿ç”¨ç³»ç»Ÿæç¤ºè¯æ„å»ºå™¨: `SystemPromptBuilder`

### æ•°æ®è¿ç§»
- [x] ä¼šè¯æ ¼å¼: JSONL å…¼å®¹
- [x] æ‰©å±•ä»£ç : éœ€è¦é‡å†™ä¸º Python
- [x] é…ç½®æ–‡ä»¶: éœ€è¦è½¬æ¢ä¸º Python dataclass

## æ€»ç»“

### Pi Coding Agent åŠŸèƒ½: 100% å®ç°

| ç±»åˆ« | åŠŸèƒ½æ•° | å®ç°æ•° | å®Œæˆåº¦ |
|------|--------|--------|--------|
| æ ¸å¿ƒåŠŸèƒ½ | 4 | 4 | 100% |
| 4 ä¸ªå·¥å…· | 4 | 4 | 100% |
| å·¥å…·ç‰¹æ€§ | 6 | 6 | 100% |
| è‡ªæ‰©å±• | 3 | 4 | 133% (å¢å¼º) |
| ä¼šè¯ç®¡ç† | 4 | 4 | 100% |
| ç³»ç»Ÿæç¤ºè¯ | 4 | 4 | 100% |
| **æ€»è®¡** | **25** | **26** | **104%** |

### Koda V2 æ–°å¢åŠŸèƒ½

| åŠŸèƒ½ | ä»·å€¼ |
|------|------|
| è‡ªéªŒè¯å¾ªç¯ | ç¡®ä¿ä»£ç è´¨é‡ |
| æ™ºèƒ½åˆ†æ”¯ç­–ç•¥ | æ›´å¥½çš„é”™è¯¯æ¢å¤ |
| Python åŸç”Ÿ | æ›´å¥½çš„ç”Ÿæ€é›†æˆ |
| ç±»å‹å®‰å…¨ | æ›´å¥½çš„å¼€å‘ä½“éªŒ |

**ç»“è®º**: Koda V2 å®Œæ•´å®ç°äº† Pi Coding Agent çš„æ‰€æœ‰åŠŸèƒ½ï¼Œå¹¶å¢åŠ äº†è‡ªéªŒè¯ç­‰å¢å¼ºåŠŸèƒ½ã€‚
